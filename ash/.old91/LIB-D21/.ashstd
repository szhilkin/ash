#! /usr/new/bin/ash
#
#-----------------------------------------
# Стандартная настройка интерпретатора ash
# вто сен 18 15:55:32 MSD 1990
#-----------------------------------------
#
# Содержимое этого файла содержит информацию, которая может быть изменена
# пользователем. Ответственность за любые исправления ложится на их автора.
#
# Формат файлов настройки будет развиваться, подробности в конце файла.
#       Названия клавиш:
-1Cmd.sh
-2Menu
-3View
-4Edit
-5Copy
-6MovRen
-7Create
-8Remove
-9Set-UP
-0Exit

# Умолчания: как заполнить(fill), откуда(in), куда копировать(out).
#  : - встроенная команда ls (понимает флаги -F, -L)
#-f:FL

-f:
-i.
-o.

# Действие над файлом(объектом). Проверяется условие [доступ_@,тип,шаблон].
# таблица может быть расположена в любом месте, см. ниже  +View, +ed, ...
+Del
	r?x d .*        _msg Не руби сук, на котором сидишь...
	rwx d *         rm -r #@
	rw? [AOD] *     rm -f #@
	rw? T *         rm -f #@
	r-? T *         _yes "Файл только для чтения, Уничтожить?" :rm -f #@
#
# Реакция на клавишу. Проверяется условие [доступ_in,пометка].
#

# Редактирование последней команды sh:
:[1!]
	r?x ?   _sh
# Меню пользователя
:2
	r?x ?   _menu2 .ashmenu
# Просмотр файла
:3
	r?x ?   +View
+View
	r?? ? *.C       ccat #@
	r?? ? *.Z       zcat #@
	r?? A *.a       ar t #@
	r?? O *.o       :nm -ng #@
	r?? O *         nm -ng #@
	r?? D *.tar     tar tvf #@
	r?? D *         od -a #@
	r?? T ?         :cat #@
	r?? T a.*       :cat #@
	r?? T *         :more #@
	r?? E *         _msg Пустой файл
	r?x d *         :ls -a #@
+nl
	r?? ? *.C       uncompact #@
	r?? ? *.Z       uncompress #@
	r?? A *         ar xv #@
	r?? T [Mm]ake*  make -f #@
	r?? * *.tar     tar xvf #@
	r?? T *.cv      make #*.c
	r?? T *.c       make #*.o
	??x [TO] *      #@
	r?? ? .*.b      rm -fv .*.b
	r?? ? *.b       rm -fv *.b
	r?x d .         _msg Купите на Привозе селедку и крутите ей мозги - мы стоим на Дерибасовской!
	r?x d *         :cd #@

# Редактирование файла
+ed
	rwx d *         :cd #@
	r?? [OD] *      od -a #@
+edw
	rwx d *         :cd #@
	rw? T *         red #@
	r?? [OD] *      od -a #@
:4
	r-x ?   +ed
	rwx ?   +edw
# Копирование файлов (требуется еще один аргумент)
:5
	rwx -   cp #@ #@
	r?x ?   cp ## <>
# Переименование/перенос файлов (требуется еще один аргумент)
:6
	rwx -   mv #@ #@
	rwx ?   mv ## <>
# Новая программа клавиш ash:
# Создание файла/каталога/файлов.системы/формат.диска
:7
	r-x ?   _file .
	r?x ?   _cmdset .ashcreat
# Уничтожение файлов/каталогов
:8
	r-x ?           _err Запись в каталог запрещена
	rwx -           +Del
	rwx ?           rm -fv ##
# Настройка интерпретатора (флаги, команды)
:9
	??? ?   _sup
# Конец работы, ВЫХОД
:0
	* *     exit
# Полезное действие (зависит от файла), см. выше +nl, +View
:NL
	??? ?   +nl
:^F
#       Освежить стандартную настройку ash
	r?x ?   _cmdset .ashstd
:&
#       Программа клавиш ash для работы с процессами
	* *     _cmdset .ashproc

:U[-.,0-9]
	* *     _msg нажимайте обычные клавиши с цифрами...
#
# Прочие часто используемые команды:
#
:[/Pa-z]
#       любая клавиша нижнего регистра - начало ввода команды sh.
	??? ?   _sh #k
#
# Напоминание. Вся работа идет в латинском регистре,
#              в принципе возможно придумать и что-либо другое...
:[Ю-Чю-ъ]
	??? ?   _msg Включите латинский регистр

:S
#       Статус процессов
	* *     :ps
#:A
##       Показать программу клавиш ash (Этот файл).
#        * *     more /usr/local/lib/ash/.ashstd
:H
#       Перейти в домашний каталог (HOME)
	* *     :cd
:M
#       Перейти в каталог с документацией
	* *     :cd /usr/man
:I
	* *     :cd /usr/include
:E
	* *     :cd /etc
:U
	* *     :cd ..
:R
# Повторить редактирование
	* *     :red
#:D
## Сравнить два помеченных файла
#        * *     diff ##
:F
	??? -   :file #@
	??? ?   :file ##
:L
	??? -   :ls -la
	??? ?   :ls -ld ##
:X
# Поменять права доступа файла
	* -     chmod +x #@
	* ?     chmod +x ##
:W
	* -     +wprot
	* ?     chmod -w ##
+wprot
	?w? ? *         chmod -w #@
	?-? ? *         chmod +w #@
:[?]
	* *     _file #@

:^Z
:^B
# Приостановить ash, вернуться в csh
	* *     _sus
:@
# Отладка подстановки ash:
#       #e - редактор (из переменной окружения EDITOR, или red)
#       #@ - имя возле курсора (строка главного меню, обычно имя файла).
#       #* - имя без суффикса
#       #s - суффикс имени с точкой
#       #S - суффикс имени без точки
	* *     _sh '#e' '#*' '#s' '#S'


#-----------------------------------------
# Структура файла настройки (Формат будет меняться).
#
#
# Строка начинается с одного из символов:
#       # строка комментария и пустая строка игнорируются;
#       : код нажатой клавиши, начало программы этой клавиши;
#       + действие (имя действия), начало таблицы действия над пунктом меню;
#       пробел, табуляция
#         продолжение таблицы программы клавиши или действия.
# Символ типа файла (в таблицах действий):
#       d       каталог (directory)
#       b       блочный специальный (например /dev/rk0)
#       c       символьный специальный (например /dev/tty1)
#       E       пустой (Empty)
#       O       объектный формата a.out (Object)
#       A       архивный (формат программы ar)
#       T       текстовый  (Text)
#       D       неопознанные данные (Data)
#-----------------------------------------
# Конец файла настройки .ashstd
#-----------------------------------------
