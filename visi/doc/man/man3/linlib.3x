.TH LINLIB 3x LINLIB
.SH ИМЯ
linlib \- ОБЩЕЕ ОПИСАНИЕ БИБЛИОТЕКИ linlib
.SH
.ES
 +----------+   БИБЛИОТЕКА ВВОДА-ВЫВОДА
(c) linlib  !   ДЛЯ АЛФАВИТНО-ЦИФРОВЫХ
 +----------+   ВИДЕОТЕРМИНАЛОВ
.EE
.SH ФОРМАТ
.ES 5

#include <stdio.h>
#include <line.h>
#include "linebp.h"

.EE
.SH ОПИСАНИЕ
Библиотека функций linlib входит в состав инструментального комплекса
с тем же названием, который предназначен
для создания мобильных интерактивных программ для мини- и микро-ЭВМ.
Комплекс ориентирован на использование
языка программирования Си.
К настоящему времени имеются варианты
для ОС RT-11, начиная с версии 4.0 (РАФОС-2)
и ОС ДЕМОС, версия 2.0.
Возможен перенос как инструментальных средств, так и
готовых прикладных программ в среду других ОС.
Подключение новых типов терминалов не требует
перетрансляции уже готовых программ.
В библиотеке ввода/вывода linlib широко используется
стандартная библиотека stdio, хотя имеются некоторые
ограничения:
.JP
Нежелательно использовать
printf и другие функции стандартного пакета stdio, которые
непосредственно делают вывод на экран.
Данное ограничение не касается развитых терминалов с полной кодовой
таблицей, но его не стоит забывать, если требуется обеспечить
переносимость.
Как известно, драйвер терминала ОС ДЕМОС
делает перекодировку для терминалов, не имеющих
полной кодовой таблицы кои-7 или кои-8.
Вследствие этого некоторые символы всегда
занимают две позиции, тогда как выделение прописных букв можно
подавить.
В библиотеке linlib предусмотрены запросы для
вывода символов и строк с гарантией, что
любой символ будет занимать одну позицию, хотя при
этом возникает некоторая неоднозначность изображения.
Альтернативное решение заключается в том, что-бы
вообще отказаться от кода кои-8 и пользоваться основным
стандартом ASCII либо совмещенной таблицей кои-7.
.JP
на вводе нельзя использовать функции библиотеки stdio -
это принципиальное ограничение, связанное с поддержкой
асинхроннных заданий.
.PP
Минимальные требования к аппаратуре видеотерминалов:
.JP
символьный код ASCII, КОИ-8, либо КОИ-7.
.JP
Наличие возможности адресации курсора;
.JP
наличие клавиш управления курсором;
.JP
формат экрана 24 строки шириной 80 символов;
формат экрана может быть и другим, однако для экранов
меньшего размера придется переделать готовые программы в
части описаний экранных форм.
.PP
Желательно, чтобы клавиатура имела несколько функциональных
клавиш, и терминал умел выделять на экране произвольные
фрагменты видеоатрибутами (реверсивным изображением,
подчеркиванием, мерцанием).
.SH СОСТАВ ИНСТРУМЕНТАЛЬНОГО КОМПЛЕКСА
.SI
.SS "Библиотека процедур (функций) организации диалога."
Программисту
предлагаются средства различного уровня, которые условно разбиты на четыре
части:
.TP
1 -
функции обеспечения независимости от операционной системы,
режимов драйвера терминала, подробно см. lin1(3x).
.TP
2 -
функции управления экраном терминала и клавиатурой,
например установить положение и атрибуты курсора, прочитать код
нажатой клавиши, подробно см. lin2(3x).
.TP
3 -
функции для работы со страницами экрана, подробно см. lin3(3x).
.TP
4 -
различные сервисные функции,
включая средства выноса описаний страниц из текстов программы,
подробно см. lin4(3x).
.SS "ПРЕПРОЦЕССОРЫ VISI"
Надстройка над средствами высоского уровня LINLIB,
имеет в своем составе расширяемый набор препроцессоров,
которые деляют процесс подготовки
экранного диалога наглядным и неутомительным. Подробно см. visi(3x).
.SS "ДЕМОНСТРАЦИОННАЯ ПРОГРАММА ldemo"
предлагается конечному
пользователю в качестве средства обучения основным понятиям
linlib, а программисту - в качестве образца для
собственных проектов. Подробная информация по этой
программе, включая основные понятия, приведена
в ldemo(1), а также в самой программе и ее исходных текстах.
.SS КОМПИЛЯТОР ВЫНЕСЕННЫХ ОПИСАНИЙ СТРАНИЦ lbp
Служит для подготовки описаний страниц, выносимых из
прикладной программы в отдельные файлы. в составе демонстрационной
программы ldemo (см. выше) имеется пример такого описания.
.SS "ПРОГРАММА ПОДГОТОВКИ ОПИСАНИЙ \
ТЕРМИНАЛОВ TCP.SAV"
Полезна при подготовке полных описаний для каждого конкретного
терминала в ОС RT-11(TSX, РАФОС).
По принципу работы несколько напоминает команду
tset ОС ДЕМОС.
.PP
.SH НАСТРОЙКА НА ТИП ТЕРМИНАЛА
.PP
Для настройки используется библиотека termcap ОС ДЕМОС.
В несколько измененном виде она используется и для
поддержки linlib в ОС RT-11 (РАФОС).
Для настройки предварительно формируются отдельные файлы описаний -
по одному на каждый тип терминала, при помощи программы
TCP.SAV.
Для идентификации прогаммой типа терминала должно
быть назначено логическое
имя "TTY:" устройству, где хранятся файлы (файл) описаний
возможностей терминалов.
Для комплексов с одним терминалом достаточно,
чтобы на этом устройстве был доступен файл TRMCAP.VT0.
Для многотерминальных комплексов с различными моделями дисплеев
дополнительно должно быть
назначено логическое имя VT*: псевдоустройству NL:,
где * может принимать
любое значение, допустимое для логических имен, обычно '0-9'.
Все, что нужно сделать, это добавить к стартовому файлу
каждой физической линии строки
.ES
ASSIGN NL: VT*:
ASSIGN SY: TTY:
.EE
и разместить на
системном диске файлы TRMCAP.VT*.
.SH ФАЙЛЫ
.SS ОС ДЕМОС:
.JP /etc/termcap -
описание возможностей терминалов, включенных в систему
.SS ОС RT-11 (TSX-PLUS, РАФОС-TS, NTS):
.JP TTY:TRMCAP.VT0 -
полное описание (без 'tc=...') для одного терминала (RT-11/SJ,
РАФОС/SJ);
.JP TTY:TRMCAP.DAT -
база описаний терминалов, включенных в систему;
.JP VT*:TRMCAP.VT0 -
имя файла для идентификации терминала;
.JP TTY:TRMCAP.VT* -
полное описание (без 'tc=...') для каждого терминала (TSX-PLUS,
РАФОС-TS).
.PP
.SH ДОПОЛНИТЕЛЬНЫЕ ССЫЛКИ
stdio(2), ldemo(1), vcc(1), visi(3x), lin1(3x), lin2(3x),
lin3(3x), lin4(3x), ajobs(3x),
termlib(3x), termcap(5)
.SH ДИАГНОСТИКА
В исполняющей библиотеке linlib предусмотрена
выдача диагностических сообщений.
Подразумевается, что они содержат достаточно
информации, чтобы их не пояснять здесь.
.SH ЗАМЕЧАНИЯ
Описания всякого рода задержек при выдаче некоторых кодов и
символов-заполнителей игнорируются,
поскольку не было возможности протестировать linlib
на большом количестве типов терминалов и терминальных интерфейсов.
.PP
В ОС ДЕМОС возникают некоторые проблемы с описаниями в
файле /etc/termcap: например для терминала VT100 (DEC)
коды клавиш курсора описаны так, как удобно для полудуплексного
терминального драйвера - они генерируют коды, не совпадающие
с командами перемещения курсора. этот режим включается одновременно
с переключением дополнительной клавиатуры, что удобно для редактора
red, но не всегда удобно для linlib - было изменено описание
этого терминала в расчете на дуплексный драйвер.
