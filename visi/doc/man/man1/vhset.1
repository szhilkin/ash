.TH VHSET 1 LINLIB
.SH ИМЯ
vhset, linlib \- НАСТРОЙКА СРЕДЫ ПОЛЬЗОВАТЕЛЯ
.SH
.ES
 +----------+   БИБЛИОТЕКА ВВОДА-ВЫВОДА
(c) linlib  !   ДЛЯ АЛФАВИТНО-ЦИФРОВЫХ
 +----------+   ВИДЕОТЕРМИНАЛОВ
.EE
.SH ФОРМАТ
 vhset

.SH ОПИСАНИЕ
.PP
Эта команда предназначена для настройки
среды прикладных программ, выполненных по технологии LINLIB.
.PP
Эта программа тесно связана с поддержкой независимости от
терминала, которая сделана в исполняющей библиотеке LINLIB.
В основу положена система termcap, которая, как известно,
предоставляет довольно низкий и неудобный для прикладного
программиста  уровень работы с терминалом.
Набор служебных клавиш у различных терминалов
отличается в большом диапазоне,
поэтому программы, которые пользуются termcap, вынуждены тем или
иным способом осуществлять привязку реальных клавиш
к конкретным действиям.
.PP
Для телеграфного стиля работы в драйвере терминала
поддерживается так называемый "испеченный" (cooked) режим,
в котором драйвер отрабатывает несколько стандартных команд,
необходимых для редактирования вводимой информации и
управления процессами.
Например, при помощи команды stty можно
назначить клавише DEL (забой) смысл "прервать процесс" либо
"отменить последний символ", либо другое действие из известного
перечня.
.PP
В LINLIB аналогично имеется несколько стандартных клавишных команд,
которые имеют совершенно определенный смысловой код. Подробный
перечень этих команд имеется в файле line.h.
В тексте прикладной программы используются только логические коды.
Считается, что набор служебных клавиш достаточен
для того, чтобы обеспечить каждому смысловому коду уникальную клавишу.
.PP
Конкретная привязка клавиш терминала и выполняемых по их нажатию действий
делается во время запуска любой LINLIB-программы.
Настройка пользователя хранится в его домашнем каталоге.
Если ее нет, то берется настройка, которую сделал
системный программист, если и такой нет, то действуют
умолчания.
.PP
Аналогичный подход применяется и к видеоатрибутам. Их
смысл (его можно трактовать и иначе) в том , чтобы
повысить наглядность изображения на экране, не более того.
Иногда все эти реверсы, мигания, подчеркивания начинают
несколько раздражать. В LINLIB можно избавиться и от
них, на время, до лучшего настроения, например. Причем сразу
во всех LINLIB-программах. Подробно так называемые
"логические видеоатрибуты" описаны в linlib(3x).
.PP
Диалог с программой vhset достаточно простой, поскольку сама
она выполнена тоже по технологии LINLIB.
В начале работы программы на экране изображено меню,
выбор осуществляется подводом курсора к началу требуемого поля
и нажатием клавиши "пробел". Для всех дальнейших
действий программа vhset имеет достаточно пояснений,
что-бы их здесь не описывать, гораздо важнее понять
сам смысл этой программы.
.PP
Программа vhset должна работать, если терминал правильно описан
в базе termcap. Однако для сохранения настройки
требуется наличие файла с определенным именем в определенном
каталоге, которые известны vhset и остальным LINLIB-программам.
таких мест два.
.JP 1
каталог
.EX /usr/line/.vhset
который должен быть доступен всем для поиска, а его файлы
всем для чтения.
.JP 2
каталог
.EX .vhset
в домашнем каталоге пользователя, должен быть доступен.
.PP
Далее, в каждом из этих каталогов должно быть доступно
несколько файлов с именами терминалов, на которых вам приходится
работать. Если вы пользуетесь несколькими вариантами описания
для одного и того же терминала, например с разной шириной экрана,
то полезно внести небольшое дополнение в базу /etc/termcap.
Добавьте к базовому описанию терминала ключ
.EX :lh=ИМЯ:
где ИМЯ - это базовое имя терминала. Таким образом вы получите
единообразную настройку для LINLIB-программ по клавишным
командам и видеоатрибутам, тогда как описание экрана легко
можно будет менять.
.PP
Таким образом, в каталогах .vhset должно быть несколько
файлов с именами доступных вам терминалов. Для начала
работы с vhset они могут быть пустыми.
.PP
Положение каталога .vhset можно указать при помощи переменной
оболочки VHSET. Для обычных пользователей это,
как правило, домашний каталог. Однако, если в оболочке
такой переменной нет, то настройка будет считана
со стандартного места
.EX /usr/line
если там есть каталог .vhset.
.PP
Теперь смысл команд, приводимых ниже, должен быть очевиден.
.SH ПРИМЕРЫ
.ES
cd; mkdir .vhset; cd .vhset
touch $TERM;
cd; vhset
ldemo;
.EE
.SH ФАЙЛЫ
.JP "/usr/line/.vhset"
стандартный каталог для хранения файлов настройки
.JP ".vhset"
каталог для хранения файлов настройки
.SH ОБОЛОчКА
.JP "VHSET"
Каталог, в котором должен храниться каталог ".vhset".
.SH ДОПОЛНИТЕЛЬНЫЕ ССЫЛКИ
linlib(3x), ldemo(1), termcap(5), termlib(3x), environ(7).
.SH ЗАМЕЧАНИЯ
Надо бы иметь более развитый стандарт, чем termcap,
но от разнобоя терминалов не спасет никакой
технический прогресс, как раз наоборот.
.PP
К сожалению, нечасто попадаются примеры решений, которые можно
было бы позаимствовать, поэтому приходится изобретать.
Например в экранном редакторе red v3.9 набор клавишных команд
основан на том предположении, что всегда есть
или правая переключаемая клавиатура, или хотя-бы клавиша LF (ПС).
А если нет ни того, ни другого?
Несомненно, все возможные чудеса в условиях разнобоя оборудования
предугадать невозможно, однако пытаться выработать общий подход
наверное полезно.
